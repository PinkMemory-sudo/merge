# DQL

**通配符查询**

**正则表达式查询**

## 基础查询





**between**

包括两端的值

**in**

与OR等价

```
where id in(值1,值2);
```

```
where id=值1 OR id=值2;
```

当多个值时in更直观，而且**in速度一般要快**，常用来连接子查询。

**空值检查**

一个列不包含值时就是NULL，可以使用`IS NULL`判断。

不为空且不是空字符串

```
where ISNULL(name)=0 and LENGTH(trim(name))>0;
```

**NOT**

用于否定后面的条件

**LIKE**

| 通配符 | 描述               |
| ------ | ------------------ |
| %      | 任意字段出现任意次 |
| _      | 单个字符           |

**排序**

order by，对查询结果(基础查询，分组查询，子查询，联结查询)进行排序

通过order by,来指定一个或多个字段来进行排序

```mysql
order by 字段1 [desc], 字段2 [desc];
```

a和A的比较取决于数据库如何设置

**limit**

取前n行

```mysql
limit n;
```

从第n行开始的m行(第一行是1)

```mysql
limit n,m;
```

排序与limit组合使用来取最符合条件的n个。

**destinct**

* 必须放在开头
* 一般用来和count来查询不重复的条数
* 作用域后面的所有字段(即所有字段都相同才算重复)



## 分组查询

通过WHERE获得了相对小的表，然后按照指定的条件将这张表分成多个小表，计算每个小表中的汇总信息，每个小表返回一个汇总信息，最后这些汇总信息形成一张表。



GROUP BY来分组

* 可以按照多个字段进行分组
* select的字段都必须是在group by中给出的
* 如果分组有NULL，NULL也会作为一组
* 支持别名

**按表达式进行分组**



**按多个条件进行筛选**



**HIVING**

where是在分组前对数据进行过滤，而HAVING是来过滤分组后的聚合数据



## 子查询

一个SELECT的查询结果用在另一个SQL语句中。用()将SELECT语句括起来，放到另一个SQL(不止SELECT语句)语句中



**别名**

```mysql
column_name as alias
```

as可以省略



**子查询的分类**

* 一行一列
* 一行多列
* 多行多列

**子查询可以的位置**

* WHERE/HIVING后面
* SELECT后
* FROM
* EXISTS(用来判断子查询有没有值)



| 操作符    | 含义                           |
| --------- | ------------------------------ |
| IN/NOT IN | 符合IN中的都要/不要            |
| ANY/SOME  | 符合ANY/SOME中任意一个值都可以 |
| ALL       | 需要满足ALL中的所有值          |

* ANY/SOME/ALL都可以替代，中文比较难理解，一般用的很少这三个。
* IN后面的子查询，最好看看能不能DISTINCT



```mysql
SELECT *
FROM employees
WHERE id=(SELECT id FROM table_name)
AND name=(SELETC name FROM table_name)

```

当多个子查询是查询的同一张表，条件也相同时，可以考虑合并一下

```mysql
SELECT *
FROM employees
WHERE (id,nam)=(
    SELECT id,name FROM table_name
)
```





## 联结

联结是MySQL最强大的功能之一，多表查询，拿一张表去匹配另一张表。





### **内联结**

先做笛卡尔积，然后按照条件进行过滤

**保证联结一定有where语句**

起别名后就要使用别名，不能再使用原始的表名



**等值联结**

连接条件由`=`组成



**非等值联结**

连接条件不再由`=`连接

比如根据薪水去联结员工等级表，薪水在某一区间的联结到某一等级



**自联结**

(等值联结)，一张表需要查询两次，就可以写成自联结



大小表数据，where的对比





### **外联结**



**左(右)外联结**

左连接：左边的表，不管等不能联结上右边的表，每一行都是需要的。右联结就是右边表的每一行都是需要的。

```mysql
SELECT *
FROM table_name1 t1
LEFT JOIN table_name2 t2
ON 联结条件
WHERE 过滤条件
```



**全外联结**

MySQL不支持全外联结。





### 交叉联接

`CROSS JOIN`,与`FROM table1,table2`相同，取得笛卡尔积











# DDL



## 库的管理



**查看都有哪些数据库**

`show databases`

可以看到四个系统自带的数据库：

`information_schema`  保存元数据信息。 MySQL服务有多少个数据库，各个数据库有哪些表，各个表中的字段是什么数据类型，各个表中有哪些索引，各个数据库要什么权限才能访问 。

`mysql`  保存用户信息

`performace_schema`  收集数据库服务器性能参数； 提供进程等待的详细信息，包括锁、互斥变量、文件信息 

`test`  空的数据库





















# **计算字段**

有许多存储在数据库中的值和程序需要的字段值在格式或者组合上是不一致的，需要检索出来后经过格式转换，计算等再返回给客户端。

计算字段是运行SELECT语句时创建的。



**字符串计算**

**concat()**

将括号里面的所有值拼接成一个字符串

**RTrim()**



**数字计算**

加减乘除














































