HDFS：Hadoop DIstributed File System，是一个分布式文件系统，将文件存在多台机器上，解决大数据的存储问题。



**使用场景**：一次写入，多次读出的场景





## **组成**



**NameNode**

数据都存在什么位置。存储文件的元数据，如文件名，文件目录结构，文件属性(生成时间，副本数，文件权限)，以及每个文件的块列表和块所在的DataNode等。

* 管理HDFS的名称空间

* 配置副本策略
* 管理数据块（Block）映射信息
* 处理客户端读写请求。  



**DataNode**

具体存储数据的位置。在本地文件系统存储文件块数据，以及块数据的校验和。

* 存储实际的数据块；
* 执行数据块的读/写操作 



**客户端**

* 文件切分。文件上传HDFS的时候，Client将文件切分成一个一个的Block，然后进行上传
* 与NameNode交互，获取文件的位置信息
* 与DataNode交互，读取或者写入数据
* Client提供一些命令来管理HDFS，比如NameNode格式化
* Client可以通过一些命令来访问HDFS，比如对HDFS增删查改操作； 



**2NN**

辅助NameNode工作。每隔一段时间对NameNode元数据备份，当NameNode挂掉的时候，它并不
能马上替换NameNode并提供服务。

* 辅助NameNode，分担其工作量，比如定期合并Fsimage和Edits，并推送给NameNode
* 在紧急情况下，可辅助恢复NameNode。  



HDFS中的文件在物理上是分块存储（Block），块的大小可以通过配置参数 ( dfs.blocksize）来规定，默认大小在Hadoop2.x/3.x版本中是128M，1.x版本中是64M。 



**为什么块的大小不能设置太小，也不能设置太大？**



# HDFS 的 Shell 操作 



格式：` hadoop fs 具体命令 OR hdfs dfs 具体命令 ` , 两个完全相同



# HDFS的API操作



# **HDFS的读写流程**



# 1NN和2NN的工作机制



# DataNode





# Interview



**为什么块的大小不能设置太小，也不能设置太大?**

（1）HDFS的块设置太小，会增加寻址时间，程序一直在找块的开始位置；
（2）如果块设置的太大，从磁盘传输数据的时间会明显大于定位这个块开始位置所需的时间。导致程序在处理这块数据时，会非常慢。
总结：HDFS块的大小设置主要取决于磁盘传输速率。



**HDFS的读写流程**